(function(f,T,S,h,A,U,B,E){"use strict";function M(e){const{metro:{findByProps:s,findByStoreName:a,common:{lodash:{merge:o}}}}=e,n=s("_sendMessage"),{createBotMessage:t}=s("createBotMessage"),c=s("BOT_AVATARS"),{getChannelId:p}=a("SelectedChannelStore");return function(l,r){if(l.channelId??=p(),[null,void 0].includes(l.channelId))throw new Error("No channel id to receive the message into (channelId)");let d=l;if(l.really){typeof r=="object"&&(d=o(d,r));const i=[d,{}];i[0].tts??=!1;for(const m of["allowedMentions","messageReference"])m in i[0]&&(i[1][m]=i[0][m],delete i[0][m]);const g="overwriteSendMessageArg2";return g in i[0]&&(i[1]=i[0][g],delete i[0][g]),n._sendMessage(l.channelId,...i)}return r!==!0&&(d=t(d)),typeof r=="object"&&(d=o(d,r),typeof r.author=="object"&&function(){const i=r.author;typeof i.avatarURL=="string"&&(c.BOT_AVATARS[i.avatar??i.avatarURL]=i.avatarURL,i.avatar??=i.avatarURL,delete i.avatarURL)}()),n.receiveMessage(d.channel_id,d),d}}function R(e,s,a){if(!e?.name||!e?.description)throw new Error(`No name(${e?.name}) or description(${e?.description}) in the passed command (command name: ${e?.name})`);if(e.displayName??=s?.names?.[a]??e.name,e.displayDescription??=s?.names?.[a]??e.description,e.options){if(!Array.isArray(e.options))throw new Error(`Options is not an array (received: ${typeof e.options})`);for(var o=0;o<e.options.length;o++){const t=e.options[o];if(!t?.name||!t?.description)throw new Error(`No name(${t?.name}) or description(${t?.description} in the option with index ${o}`);if(t.displayName??=s?.options?.[o]?.names?.[a]??t.name,t.displayDescription??=s?.options?.[o]?.descriptions?.[a]??t.description,t?.choices){if(!Array.isArray(t?.choices))throw new Error(`Choices is not an array (received: ${typeof t.choices})`);for(var n=0;n<t.choices.length;n++){const c=t.choices[n];if(!c?.name)throw new Error(`No name of choice with index ${n} in option with index ${o}`);c.displayName??=s?.options?.[o]?.choices?.[n]?.names?.[a]??c.name}}}}return e}function C(e,s=27){if(typeof e!="string")throw new Error("Passed chars isn't a string");if(e?.length<=0)throw new Error("Invalid chars length");let a="";for(let o=0;o<s;o++)a+=e[Math.floor(Math.random()*e.length)];return a}const $={command:"https://cdn.discordapp.com/attachments/1099116247364407337/1112129955053187203/command.png"},y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=y.replace("+/","_-");function b(e,s){if(typeof e!="number")throw new Error(`Passed data isn't a number (received: ${typeof e})`);let a="";for(;e>0;)a=(s?w:y).charAt(e%64)+a,e=Math.floor(e/64);return a}const{meta:{resolveSemanticColor:N}}=h.findByProps("colors","meta"),P=h.findByStoreName("ThemeStore"),v=function(){return parseInt(N(P.theme,T.semanticColors.BACKGROUND_BASE_LOWER).slice(1),16)},_={author:{username:"RynZen",avatar:"command",avatarURL:$.command}};let u;function k(){return window.sendMessage?window.sendMessage?.(...arguments):(u||(u=M(vendetta)),u(...arguments))}var O={meta:vendetta.plugin,patches:[],onUnload(){this.patches.forEach(function(e){return e()}),this.patches=[]},onLoad(){var e=this;const s="Copy Token",a=B.before("render",h.findByProps("ScrollView").View,function(o){try{let n=A.findInReactTree(o,function(r){return r.key===".$UserProfileOverflow"});if(!n||!n.props||n.props.sheetKey!=="UserProfileOverflow")return;const t=n.props.content.props;if(t.options.some(function(r){return r?.label===s}))return;const c=h.findByStoreName("UserStore").getCurrentUser()?.id,p=Object.keys(n._owner.stateNode._keyChildMapping).find(function(r){return n._owner.stateNode._keyChildMapping[r]&&r.match(/(?<=\$UserProfile)\d+/)})?.slice?.(13)||c,l=h.findByProps("getToken").getToken();t.options.unshift({isDestructive:!0,label:s,onPress:function(){try{E.showToast(p===c?"Copied your token":`Copied token of ${t.header.title}`),U.setString(p===c?l:[Buffer.from(p).toString("base64").replaceAll("=",""),b(+Date.now()-129384e4,!0),C(w,27)].join(".")),t.hideActionSheet()}catch(r){console.error(r);let d=!1;try{d=a()}catch{d=!1}alert(`[TokenUtils \u2192 context menu patch \u2192 option onPress] failed. Patch ${d?"dis":"en"}abled
`+r.stack)}}})}catch(n){console.error(n);let t=!1;try{t=a()}catch{t=!1}alert(`[TokenUtils \u2192 context menu patch] failed. Patch ${t?"dis":"en"}abled
`+n.stack)}});this.patches.push(a);try{[R({type:1,inputType:1,applicationId:"-1",execute:{async generate(n,t){try{const c={..._,interaction:{name:"/token generate",user:h.findByStoreName("UserStore").getCurrentUser()}},{getToken:p}=h.findByProps("getToken"),l=p(),r=(await(await fetch(`https://rynzen.pages.dev/api/token-encryption?t=${encodeURIComponent(l)}`)).json()).data;k({loggingName:"Token generate output message",channelId:t.channel.id,embeds:[{color:v(),type:"rich",title:"Encrypted Token",description:`${r}`}]},c),k({loggingName:"Token generate warning message",channelId:t.channel.id,content:"use the /token set command, or /auto-r4id with caution!"},c)}catch(c){console.error(c),alert(`There was an error while executing /token generate
`+c.stack)}}}.generate,name:"token generate",description:"Generates an encrypted token"})].forEach(function(n){return e.patches.push(S.registerCommand(n))})}catch(o){console.error(o),alert(`There was an error while loading TokenUtils
`+o.stack)}}};return f.EMBED_COLOR=v,f.default=O,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.ui,vendetta.commands,vendetta.metro,vendetta.utils,vendetta.metro.common.clipboard,vendetta.patcher,vendetta.ui.toasts);
